----------------------
Tue May  3 16:53:52 CEST 2022
----------------------
 
WARNING: ignoring environment value of R_HOME
[1] "Loading functions from: scripts/QC_functions.R"
[1] "Loading R packages..."
[1] "Running QC_statistics.R on: wg2_onek1k_subset"
[1] "Reading azimuth_l1_l2 pairing file in: azimuth_l1_l2.csv"
[1] "Reading QC metrics and MAD combinations file in: qc_mad.tab"
[1] "Downsampling 100 cells from predicted.celltype.l1"
[1] "Creating output directory in: QC_statistics_examples/wg2_onek1k_subset/nCount_RNA_lower_1_5.percent.mt_upper_1_5/by_dataset/dataset/predicted.celltype.l1_100/"
[1] "Considering 2 QC metrics: nCount_RNA, percent.mt"
[1] "nCount_RNA"
[1] "MAD min: 1"
[1] "MAD max: 5"

[1] "percent.mt"
[1] "MAD min: 1"
[1] "MAD max: 5"

[1] "Reading metadata in: wg2-cell_type_classification/wg2_onek1k_subset/step4_reduce/metadata.reduced_data.RDS"
   user  system elapsed 
  0.005   0.000   0.018 
[1] "Adding Azimuth l1 classification to the metadata..."
   user  system elapsed 
  0.000   0.000   0.001 
[1] "Downsampling predicted.celltype.l1 (B) to: 100"
[1] "Downsampling predicted.celltype.l1 (CD4T) to: 100"
[1] "Downsampling predicted.celltype.l1 (CD8T) to: 100"
[1] "Downsampling predicted.celltype.l1 (DC) to: 9"
[1] "Downsampling predicted.celltype.l1 (Mono) to: 92"
[1] "Downsampling predicted.celltype.l1 (NK) to: 100"
[1] "Downsampling predicted.celltype.l1 (Platelet) to: 1"
[1] "Downsampling predicted.celltype.l1 (T_other) to: 15"
[1] "Calculating MADs and assigning Outlier/NotOutlier tags per cell barcode..."
[1] "Applying qc_mad.func function to each QC metric: assigning Outlier/NotOutlier tag to each cell depending on different MADs... "
[1] "nCount_RNA"
[1] "lower"
[1] "Peforming the QC filtering across the whole dataset..."

[1] "MAD: 1"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] 1270.101

[1] "MAD: 1.5"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] 797.1518

[1] "MAD: 2"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] 324.2024

[1] "MAD: 2.5"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] -148.747

[1] "MAD: 3"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] -621.6964

[1] "MAD: 3.5"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] -1094.646

[1] "MAD: 4"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] -1567.595

[1] "MAD: 4.5"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] -2040.545

[1] "MAD: 5"
[1] "only lower boundary..."
[1] "The lower bound is:"
[1] -2513.494

[1] "percent.mt"
[1] "upper"
[1] "Peforming the QC filtering across the whole dataset..."

[1] "MAD: 1"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 4.808384

[1] "MAD: 1.5"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 5.452821

[1] "MAD: 2"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 6.097258

[1] "MAD: 2.5"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 6.741696

[1] "MAD: 3"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 7.386133

[1] "MAD: 3.5"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 8.03057

[1] "MAD: 4"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 8.675007

[1] "MAD: 4.5"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 9.319444

[1] "MAD: 5"
[1] "only upper boundary..."
[1] "The upper bound is:"
[1] 9.963881

[1] "Joining Outlier/NotOutlier for each QC metric..."
[1] "Join tag (Outlier/NotOutlier)..."
   user  system elapsed 
 13.614   0.191   4.504 
[1] "Summarizing the data..."
[1] "By dataset..."
[1] "Counting nCells in each MAD combination"
[1] "Summarizing by dataset..."
[1] "Counting Outlier/NotOutlier tags..."
[1] "Adding missing Outlier/NotOutlier tags..."
[1] "Across the whole dataset..."
[1] "Adding missing tag in: MAD_1.5:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_1.5:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_2:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_2.5:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_3:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_3.5:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_4:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_4.5:MAD_5 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_1 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_1.5 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_2 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_2.5 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_3 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_3.5 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_4 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_4.5 (Outlier)"
[1] "Adding missing tag in: MAD_5:MAD_5 (Outlier)"
   user  system elapsed 
  0.253   0.017   0.300 
[1] "Saving summarized output in: QC_statistics_examples/wg2_onek1k_subset/nCount_RNA_lower_1_5.percent.mt_upper_1_5/by_dataset/dataset/predicted.celltype.l1_100/tag.rds"
   user  system elapsed 
  0.001   0.000   0.003 
 
----------------------
Tue May  3 16:54:06 CEST 2022
----------------------
 
